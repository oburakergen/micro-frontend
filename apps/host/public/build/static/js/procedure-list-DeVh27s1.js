import{u as e,j as t,S as a,g as r,o as s,M as l,l as d,w as o,R as i,C as n,F as c,d as m,N as u}from"./common-DEUjWhYV.js";import{t as h}from"./tigaHealthPhr__loadShare__react__loadShare__-PlbDaU_c.js";import{T as p}from"./Table-BjqSWWQP.js";import{a as g}from"./procedure-ordered-list-IFoFyNe4.js";import{D as x}from"./index.modern-DaA0Mkma.js";import"./tigaHealthPhr__mf_v__runtimeInit__mf_v__-DESDpvoH.js";import"./_commonjsHelpers-Dvrxj_Zk.js";import"./preload-helper-Cyd4LpGB.js";import"./index.modern-BcxX8faq.js";import"./Overlay-CK6O43qj.js";const b=s=>{const{procedureData:l,procedureType:d}=s,{t:o,i18n:i}=e();return t.jsxs(p,{bordered:!0,className:"fs--1",children:[t.jsx("thead",{className:"visually-hidden",children:t.jsxs("tr",{children:[t.jsx("th",{"aria-label":"table-header-label"}),t.jsx("th",{"aria-label":"table-header-label"})]})}),t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("RADIOLOGY"===d?"diagnostic-reports.name":"procedure.column-name")}),t.jsx("td",{children:a(l?.codeDisplay)})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("RADIOLOGY"===d?"diagnostic-reports.test-code":"procedure.code")}),t.jsx("td",{children:a(l?.code)})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("procedure.column-category")}),t.jsx("td",{children:a(l?.subcategory)})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("procedure.linked-diagnosis")}),t.jsx("td",{children:t.jsx("ul",{children:l?.reasonReferences?.map((e,r)=>t.jsx("li",{children:t.jsx("p",{children:a(e?.display)})},r))})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("RADIOLOGY"===d?"diagnostic-reports.test-date":"procedure.procedure-date")}),t.jsx("td",{children:r(l?.performedDate,"DD/MMM/YYYY")})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("procedure.ordered-by")}),t.jsx("td",{children:a(l?.orderingOrgName)})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("procedure.performed-by")}),t.jsx("td",{children:a(l?.performingOrgName)})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("procedure.column-status")}),t.jsx("td",{children:"In Progress"===l?.statusDisplay?o("procedure.future"):a(l?.statusDisplay)})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("RADIOLOGY"===d?"diagnostic-reports.reason-for-test":"procedure.reason-for-procedure")}),t.jsx("td",{children:t.jsx("ul",{children:l?.reasonCodes?.map((e,r)=>t.jsx("li",{children:t.jsx("p",{children:a(e)})},r))})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("procedure.performing-physician")}),t.jsx("td",{children:a(l?.performer)})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("procedure.column-notes")}),t.jsx("td",{children:t.jsx("ul",{children:l?.notes?.length>0?l?.notes.map((e,r)=>t.jsx("li",{children:t.jsx("p",{children:a(e)})},r)):"-"})})]})]})]})},D=p=>{const{t:D,i18n:j}=e(),{procedureType:f,encounterVisit:y,data:S}=p,[C,M]=h.useState([]),[w,N]=h.useState([]),[Y,R]=h.useState(!1),[T,v]=h.useState(null),[F,L]=h.useState(null),[O,I]=h.useState(null),[_,V]=h.useState([]),[k,P]=h.useState({description:null,hierarchy:null,label:D("6Month"),name:"6Month",table:"hiev_observation_criterias",value:"b73b82f8-5c0f-11ed-9b6a-0242ac120002"}),[E,A]=h.useState(!1),[B,G]=h.useState({startDate:"6Month",endDate:null}),[$,q]=h.useState({modalType:null,isModal:!1}),{handleSubmit:z,register:H,formState:{errors:K},control:W,getValues:U,setValue:J,setError:Q}=s(),[X,Z]=h.useState({}),ee=e=>{g.getProcedureData(e,t=>{t?(M(t),N(t)):(M([]),N([])),G("custom"!==k?.name?{startDate:D(k?.name),endDate:null}:{startDate:r(e?.startDate,"DD-MMM-YYYY"),endDate:r(e?.endDate,"DD-MMM-YYYY")})})};let te,ae;h.useEffect(()=>{y||g.init(e=>{e&&(V(e),J("dateRange",e?.[1]))})},[j?.language]),h.useEffect(()=>{if(E&&!y){const e=U(),t={startDate:e.startDate,endDate:e.endDate,dateRange:e.dateRange,categoryList:[f]};ee(t)}},[E]),"detailView"===$.modalType?te=t.jsx(l,{modal:$.isModal,modaltitleText:D("procedure.procedures-header"),modalWidth:"50%",toggle:()=>q({...$,isModal:!$.isModal}),component:t.jsx(b,{procedureData:X,procedureType:f})}):ae=t.jsx(l,{modal:$,modaltitleText:D("diagnostic-reports.document-modal"),modalWidth:"50%",toggle:()=>q(!1),component:null!==T?t.jsx("div",{className:"IframeContent pageFile",children:t.jsx("iframe",{width:"100%",height:"100%",src:T,frameBorder:"0",allowFullScreen:!0})}):t.jsx(d,{alertType:"info",alertText:t.jsxs("p",{className:"mb-0 marginRight20",children:[t.jsx("i",{className:"ico-info"})," ",` ${D("DataTable.data-not-found")}`]})})});const re=y?[{dataField:"subcategory",text:D("procedure.column-category"),classes:"border-0 align-middle",headerClasses:"border-0",sort:!0,formatter:e=>a(e),filterValue:e=>a(e)},{dataField:"codeDisplay",text:D("encounter-visit.procedure-card.procedure"),classes:"border-0 align-middle",headerClasses:"border-0",sort:!0,formatter:(e,r)=>t.jsx("div",{className:"inactive"===r?.status?"font-weight-semi-bold data-table-link strikeLine":"font-weight-semi-bold data-table-link",children:a(r?.codeDisplay)})},{dataField:"reasonReferences",text:D("procedure.linked-diagnosis"),classes:"border-0 align-middle",headerClasses:"border-0",sort:!0,formatter:e=>e?.length>0?e?.map((e,r)=>t.jsx("p",{children:a(e?.display)},r)):"-",filterValue:e=>e?.length>0&&e?.map(e=>e?.display)},{dataField:"status",text:D("procedure.column-status"),classes:"border-0 align-middle",headerClasses:"border-0",sort:!0,formatter:e=>a(e),filterValue:e=>a(e)}]:[{dataField:"codeDisplay",text:D("RADIOLOGY"===f?"test-lab-result.label-test-name":"procedure.procedure-name"),classes:"border-0 align-middle",headerClasses:"border-0",sort:!0,formatter:(e,r)=>t.jsx("div",{className:"inactive"===r?.status?"font-weight-semi-bold data-table-link strikeLine":"font-weight-semi-bold data-table-link",children:a(r?.codeDisplay)})},{dataField:"subcategory",text:D("procedure.column-category"),classes:"border-0 align-middle",headerClasses:"border-0",sort:!0,formatter:e=>a(e),filterValue:e=>a(e)},{dataField:"reasonReferences",text:D("procedure.linked-diagnosis"),classes:"border-0 align-middle",headerClasses:"border-0",sort:!0,formatter:e=>e?.length>0?e?.map((e,r)=>t.jsx("p",{children:a(e?.display)},r)):"-",filterValue:e=>e?.length>0&&e?.map(e=>e?.display)},{dataField:"performedDate",text:D("RADIOLOGY"===f?"diagnostic-reports.test-date":"procedure.procedure-date"),classes:"border-0 align-middle",headerClasses:"border-0 numericSort",sort:!0,formatter:(e,t)=>a(r(t?.performedDate,"DD/MMM/YYYY")),filterValue:(e,t)=>r(t?.performedDate,"DD/MMM/YYYY")},{dataField:"orderingOrgName",text:D("procedure.ordered-by"),classes:"border-0 align-middle",headerClasses:"border-0",sort:!0,formatter:e=>a(e),filterValue:e=>a(e)},{dataField:"performingOrgName",text:D("procedure.performed-by"),classes:"border-0 align-middle",headerClasses:"border-0",sort:!0,formatter:e=>a(e),filterValue:e=>a(e)},{dataField:"report",text:D("diagnostic-reports.column-report"),classes:"border-0 align-middle IconCol",headerClasses:"border-0 ",sort:!1,formatter:(e,a)=>a?.reportId?t.jsx("i",{className:"ico-health-report-1 cursor ",onClick:()=>{return e=a?.reportId,v(null),void g.getReportList(e,e=>{e.data?(v(`data:${e?.data.contentType};base64,${e?.data.data}`),q({...$,modalType:"documentView",isModal:!0})):u.Error(D("pdf-viewer.error-message"))});var e}}):t.jsx("i",{className:"ico-health-report-1 cursor ghostBtn "})},{dataField:"detail",text:D("procedure.column-detail"),classes:"border-0 align-middle IconCol",headerClasses:"border-0 ",sort:!1,formatter:(e,a)=>t.jsx("i",{className:"ico-show-1 cursor ",onClick:()=>(Z(a),void q({...$,modalType:"detailView",isModal:!0}))})}],se={DataApi:g,DataGet:S?void 0:"getProcedureData",DataGetParams:{categoryList:[f],dateRange:k,startDate:void 0,endDate:void 0},DataDetail:null,DataDelete:null,DataSearch:null,DataState:S||C,DataSetState:M,DataContentState:S||w,DataContentSetState:N,pageRowSize:20,SearchBox:!y,TableKeyField:"id",deleteComponent:null,detailComponent:null,filterComponent:null,FilterSelectState:Y,FilterSelectSetState:R,detailColumnName:null,CustomPagination:!0,excelButton:!1,cardLight:!1,cardTitle:p.header,CardClass:`CardCreate bodySearchInput procedureSearch dateRangeTable mb-3  border ${y&&"encounterVisitTitle"}`,PermissionPage:"procedures",contentComponent:!y&&t.jsx(o,{onSubmit:z(e=>{const t={startDate:e?.startDate?r(e?.startDate,"YYYY-MM-DD"):void 0,endDate:e?.endDate?r(e?.endDate,"YYYY-MM-DD"):void 0,categoryList:[f],dateRange:""===e.dateRange?null:e.dateRange};ee(t)}),children:t.jsxs(i,{className:"dateRangeFilter",children:[t.jsx(n,{lg:12,children:t.jsx(d,{alertType:"info",alertText:t.jsx("p",{className:"mb-0 marginRight20",children:null!==B?.endDate?`${D("data.date-range-text")+B?.startDate} and ${B?.endDate}`:D("data.date-range-text2")+D(B?.startDate)})})}),t.jsx(n,{lg:12,children:t.jsx(c,{CreateFormItems:[{visibilityState:!0,ColLg:"3",item:"SELECT",itemType:"single",label:D("observation.date-range"),labelStatus:!0,name:"dateRange",id:"dateRange",IsMulti:!1,options:_,defaultValue:_?_[1]:[],closeMenuOnSelect:!0,onChange:e=>P(e),placeholder:D("select.selected"),required:!1,requiredMessage:D("organization.can-not-be-empty"),disabled:!1},{visibilityState:"custom"===k?.name,ColLg:"3",item:"DATEPICKER",itemType:"datepicker",label:D("test-lab-result.start-date"),labelStatus:!0,name:"startDate",id:"startDate",className:null,clearItem:!1,rowFixed:!1,defaultValue:null,dateFormat:"dd/MM/yyyy",startDate:null,endDate:new Date,minDate:null,maxDate:O||new Date,showYear:!0,showMonth:!0,onChange:e=>L(e),placeholder:D("test-lab-result.start-date"),required:!1,readOnly:!1,disabled:!1},{visibilityState:"custom"===k?.name,ColLg:"3",item:"DATEPICKER",itemType:"datepicker",label:D("test-lab-result.end-date"),labelStatus:!0,name:"endDate",id:"endDate",className:null,clearItem:!1,rowFixed:!1,defaultValue:null,dateFormat:"dd/MM/yyyy",startDate:null,endDate:new Date,minDate:F,maxDate:new Date,showYear:!0,showMonth:!0,onChange:e=>I(e),placeholder:D("test-lab-result.end-date"),required:!1,readOnly:!1,disabled:!1},{visibilityState:!!k,ColLg:"2",item:"BUTTON",itemType:"submit",icon:null,color:"falcon-default",size:"sm",label:D("test-lab-result.search"),id:"id",className:"dateRangeBtnProcedure dateRangeBtn",rowFixed:!1,disabled:"custom"===k?.name&&!(null!==F&&null!==O)}],register:H,setValue:J,setError:Q,errors:K,control:W})})]})}),defaultSortField:"performedDate",defaultSortOrder:"desc",TableColumns:re};return t.jsx(m,{resourceName:"menu.procedures",permission:"read",type:"page",children:t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"custom"===k?.name?"SearchBox CustomDateRange":"SearchBox ",children:t.jsx(x,{ReLoadList:E,setReLoadList:A,StaticDataListItem:se})}),te,"documentView"===$.modalType?ae:null]})})};export{D as default};
