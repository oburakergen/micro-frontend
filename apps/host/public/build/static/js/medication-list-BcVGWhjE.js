import{h as e,i as t,u as i,j as s,S as a,g as l,v as d,f as n,o as r,c,M as o,R as m,C as h,T as x,l as u,Y as j}from"./common-DEUjWhYV.js";import{t as p}from"./tigaHealthPhr__loadShare__react__loadShare__-PlbDaU_c.js";import{D as g}from"./index.modern-DaA0Mkma.js";import{T as D}from"./Table-BjqSWWQP.js";import{T as b,a as N}from"./ToggleButtonGroup-BpTfK3cD.js";import"./tigaHealthPhr__mf_v__runtimeInit__mf_v__-DESDpvoH.js";import"./_commonjsHelpers-Dvrxj_Zk.js";import"./preload-helper-Cyd4LpGB.js";import"./index.modern-BcxX8faq.js";import"./Overlay-CK6O43qj.js";const f=new class extends e{constructor(){super(`${t.API}/phr`)}getList(e,t){super.get(`medication/get-patient-drug-list-by-domain?masterPatientId=${e.masterPatientId}&patientDrugStatusFilter=${e.medicationDrugDomain}`,t)}getDetail(e,t){super.get(`medication/get-drug-detail-with-dispense?prescriptionNumber=${e.prescriptionNumber}&masterPatientId=${e.masterPatientId}&drugDescriptorId=${e.drugDescriptorId}`,t)}},M=e=>{const{ViewID:t}=e,[r,c]=p.useState(null),{t:o}=i();return p.useEffect(()=>{t&&f.getDetail(t,e=>{e&&c(e)})},[t]),s.jsxs("div",{className:"ModalDetail",children:[s.jsxs(D,{bordered:!0,className:"fs--1",children:[s.jsx("thead",{className:"visually-hidden",children:s.jsxs("tr",{children:[s.jsx("th",{"aria-label":"medications-list-detail"}),s.jsx("th",{"aria-label":"medications-list-detail"})]})}),s.jsxs("tbody",{children:[s.jsxs("tr",{children:[s.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("medication.label-medication-name")}),s.jsx("td",{children:a(r?.drugGenericName)})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("medication.label-qnf-link")}),s.jsx("td",{children:r?.qnfLinkUrl?s.jsx("a",{className:"mr-4 font-size-16 underline",target:"blank",href:r?.qnfLinkUrl,children:o("medication.label-qnf-click-button")}):"-"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("medication.label-medication-instructions")}),s.jsx("td",{children:a(t?.prescriptionDrugDosageList[t?.index]?.instruction)})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("medication.label-practitioners-notes")}),s.jsx("td",{children:a(t?.prescriptionDrugDosageList[t?.index]?.specialInstruction)})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("medication.label-prescription-number")}),s.jsx("td",{children:a(r?.prescriptionNumber)})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("medication.label-remaining-refills")}),s.jsx("td",{children:null!=r?.remainingRefill?r?.remainingRefill:"NA"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("medication.label-next-refill-date")}),s.jsx("td",{children:l(r?.nextRefillDate,"DD/MMM/YYYY")})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("medication.label-medication-start-date")}),s.jsx("td",{children:t?.prescriptionDrugDosageList[t?.index]?.startDate?l(t?.prescriptionDrugDosageList[t?.index]?.startDate,"DD/MMM/YYYY"):a(t?.prescriptionDrugDosageList[t?.index]?.startDate)})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("medication.label-medication-end-date")}),s.jsx("td",{children:t?.prescriptionDrugDosageList[t?.index]?.endDate?l(t?.prescriptionDrugDosageList[t?.index]?.endDate,"DD/MMM/YYYY"):a(t?.prescriptionDrugDosageList[t?.index]?.endDate)})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("medication.label-prescribing-health-facility")}),s.jsx("td",{children:a(r?.organizationName)})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("medication.label-prescribed-date")}),s.jsx("td",{children:l(r?.prescriptionDate,"DD/MMM/YYYY")})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("medication.label-prescribed-quantity")}),s.jsx("td",{children:a(t?.prescriptionDrugDosageList[t?.index]?.totalQuantity)})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"bg-100",style:{width:"30%"},children:o("medication.label-collection-status")}),s.jsx("td",{children:r?.status?o(r?.status):"-"})]})]})]}),r?.drugDispenseTransactionList.length>0&&s.jsx(d,{cardClass:"CardCreate",cardLight:!1,cardHeader:null,cardTitle:o("medication.label-collected-medication"),cardContent:s.jsx(n,{className:"CardScroller350",children:s.jsxs(D,{children:[s.jsxs("thead",{children:[s.jsx("th",{children:o("medication.label-collected-medication-name")}),s.jsx("th",{children:o("medication.label-collected-quantity")}),s.jsx("th",{children:o("medication.label-collected-from")}),s.jsx("th",{children:o("medication.label-collected-date")})]}),s.jsx("tbody",{children:r?.drugDispenseTransactionList.map((e,t)=>s.jsxs("tr",{children:[s.jsx("td",{children:e?.dispensedDrugName}),s.jsx("td",{children:e?.dispensedQuantity+" "+e?.dispensedQuantityType}),s.jsx("td",{children:e?.pharmacyName}),s.jsx("td",{children:l(e?.dispensedDate,"DD/MMM/YYYY")})]},t))})]})})})]})},Y=()=>{const{formState:{errors:e}}=r(),t=c(e=>e.roleManageStore.PatientPhysical),{t:d,i18n:n}=i(),[Y,C]=p.useState(!1),[y,S]=p.useState(null),[L,v]=p.useState([]),[I,w]=p.useState([]),[T,_]=p.useState(!1),[P,R]=p.useState(!1),[E,A]=p.useState(null),[F,V]=p.useState(null),[k,B]=p.useState([]);p.useEffect(()=>{v([]),w([]),q()},[E,n.language]);const q=()=>{let e={masterPatientId:t?.masterPatientId,medicationDrugDomain:E||"ACTIVE_PRESCRIBED"};f.getList(e,e=>{if(e){let t=[],i=[];e?.content?.map((e,s)=>{t.push({...e,id:s}),0==e?.isMultipleDosage&&i.push(s)}),v(t),w(t),B(i)}else v([]),w([])})},G=(e,i)=>{V({...e,masterPatientId:t?.masterPatientId,index:i}),S("detailView"),C(!0)};let H;"detailView"===y&&(H=s.jsx(o,{modal:Y,modaltitleText:d("medication.medication-detail"),modalWidth:"65%",toggle:()=>C(!1),component:s.jsx(M,{ViewID:F})}));const $={DataApi:f,DataGet:void 0,DataDetail:null,DataDelete:null,DataSearch:null,CustomPagination:!0,DataState:L,DataSetState:v,modalType:y,setModalType:S,modal:Y,setModal:C,DataContentState:I,DataContentSetState:w,SearchBox:!0,TableKeyField:"id",deleteComponent:null,detailComponent:null,filterComponent:null,FilterSelectState:P,FilterSelectSetState:R,detailColumnName:null,cardLight:!1,CardClass:"border-0 DataHeaderNone",cardTitle:d("medication.medication-list"),excelButton:!1,TableExpandRow:{parentClassName:"expandActive",showExpandColumn:!0,expandHeaderColumnRenderer:({isAnyExpands:e})=>e?s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"ico-minimize-2 cursor"}),s.jsx("span",{className:"visually-hidden",children:"expandRow"})]}):s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"ico-plus-1 cursor"}),s.jsx("span",{className:"visually-hidden",children:"expandRow"})]}),renderer:e=>s.jsx(p.Fragment,{children:s.jsx("div",{className:"expandContent",children:s.jsx("div",{className:"detail-content drug-detail",children:s.jsx("ul",{children:s.jsxs("li",{children:[s.jsx("div",{className:"detail"}),s.jsx("div",{className:"detail detail-main",children:s.jsxs("fieldset",{children:[s.jsx("legend",{children:s.jsx("span",{className:"label label-primary",children:a(e?.drugBrandName?e?.drugBrandName+" "+e?.drugGenericName:e?.drugGenericName)})}),s.jsx("div",{className:"p-2 position-relative",children:s.jsx("div",{className:"detail-content detail-content-table",children:s.jsxs(D,{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"drugName"}),s.jsxs("th",{children:[" ",d("medication.status")]}),s.jsx("th",{children:d("medication.label-medication-instructions")}),s.jsx("th",{children:d("medication.label-remaining-refills")}),s.jsx("th",{children:d("medication.label-medication-start-date")}),s.jsx("th",{children:d("medication.label-medication-end-date")}),s.jsx("th",{children:d("medication.label-practitioners-notes")}),s.jsx("th",{children:d("DataTable.details")})]})}),s.jsx("tbody",{children:e?.prescriptionDrugDosageList?.map((t,i)=>s.jsxs("tr",{children:[s.jsx("td",{}),s.jsx("td",{children:a(e?.status?.charAt(0)?.toUpperCase()+e?.status?.slice(1)?.toLowerCase())}),s.jsx("td",{children:s.jsx("span",{className:"INACTIVE"==e?.status?"strikeLine":null,children:a(t?.instruction)})}),s.jsx("td",{children:null!=t?.remainingRefill?t?.remainingRefill:"NA"}),s.jsx("td",{children:l(t?.startDate,"DD/MMM/YYYY")}),s.jsx("td",{children:l(t?.endDate,"DD/MMM/YYYY")}),s.jsx("td",{children:a(t?.specialInstruction)}),s.jsx("td",{className:"IconCol",children:s.jsx("i",{className:"ico-show-1 cursor ",onClick:()=>G(e,i)})})]},i))})]})})})]})})]})})})})}),nonExpandable:k},TableColumns:[{dataField:"drugGenericName",text:d("medication.label-medication-name"),classes:"border-0 align-middle fs-0",headerClasses:"border-0 administeredDate",sort:!0,formatter:(e,t)=>s.jsxs("span",{children:[s.jsx("span",{children:a(e)}),t?.isMultipleDosage&&s.jsx("span",{style:{opacity:.5},children:" - (Multiple Dosage)"})]})},{dataField:"status",text:d("medication.label-status"),classes:"border-0 align-middle fs-0",headerClasses:"border-0",sort:!1},{dataField:"",text:d("medication.label-medication-instructions"),classes:"border-0 align-middle fs-0",headerClasses:"border-0",sort:!1,formatter:(e,t)=>t?.isMultipleDosage?s.jsx("span",{children:"-"}):s.jsx("span",{className:"INACTIVE"==t?.status?"strikeLine":null,children:a(t?.prescriptionDrugDosageList[0]?.instruction)})},{dataField:"remainingRefill",text:d("medication.label-remaining-refills"),classes:"border-0 align-middle fs-0",headerClasses:"border-0",sort:!1,formatter:e=>null!=e?e:"NA"},{dataField:"prescriptionDrugDosageList[0].startDate",text:d("medication.label-medication-start-date"),classes:"border-0 align-middle fs-0",headerClasses:"border-0 numericSort medDate",sort:!0,formatter:(e,t)=>t?.isMultipleDosage?s.jsx("span",{children:"-"}):l(t?.prescriptionDrugDosageList[0]?.startDate,"DD/MMM/YYYY"),filterValue:(e,t)=>l(t?.prescriptionDrugDosageList[0]?.startDate,"DD/MMM/YYYY")},{dataField:"prescriptionDrugDosageList[0].endDate",text:d("medication.label-medication-end-date"),classes:"border-0 align-middle fs-0",headerClasses:"border-0 numericSort medDate",sort:!0,formatter:(e,t)=>t?.isMultipleDosage?s.jsx("span",{children:"-"}):l(t?.prescriptionDrugDosageList[0]?.endDate,"DD/MMM/YYYY"),filterValue:(e,t)=>l(t?.prescriptionDrugDosageList[0]?.endDate,"DD/MMM/YYYY")},{dataField:"specialInstruction",text:d("medication.label-practitioners-notes"),classes:"border-0 align-middle fs-0",headerClasses:"border-0",sort:!1,formatter:e=>a(e)},{dataField:"",text:d("DataTable.details"),classes:"border-0 align-middle IconCol ",headerClasses:"border-0",formatter:(e,t)=>t?.isMultipleDosage?null:s.jsx(x,{label:d("button.view"),children:s.jsx("i",{className:"ico-show-1 cursor",onClick:()=>G(t,0)})})}],contentComponent:s.jsx(m,{children:s.jsx(h,{lg:6,className:"text-align-left",children:s.jsxs("fieldset",{className:"form-fieldset",children:[s.jsx("legend",{className:"visually-hidden",children:"toggleButton"}),s.jsxs(b,{type:"radio",name:"options",defaultValue:2,children:[s.jsx(N,{id:"tbg-radio-2",value:2,size:"sm",variant:"falcon-default",onClick:()=>{A("ACTIVE_PRESCRIBED")},children:d("medication.active-medications")}),s.jsx(N,{id:"tbg-radio-3",value:3,size:"sm",variant:"falcon-default",onClick:()=>{A("PASSIVE")},children:d("medication.inactive-medications")})]})]})})})};return s.jsxs("div",{className:"MedicationSearch",children:[s.jsx("div",{className:"topAlert",children:s.jsx(u,{alertType:"info",alertText:s.jsxs("p",{className:"mb-0 marginRight20 d-flex",children:[s.jsx("i",{className:"ico-info",style:{paddingRight:"5px"}}),s.jsx("div",{children:s.jsx(j,{i18nKey:d("PASSIVE"===E?"medication.passive-desc":"medication.active-desc"),components:{bold:s.jsx("b",{})}})})]})})}),t&&s.jsxs("div",{className:"medicationList",children:[H,s.jsx(g,{ReLoadList:T,setReLoadList:_,StaticDataListItem:$})]})]})};export{Y as default};
