import{Z as e,j as t,W as a,aT as l,aU as s,aV as i,aW as r,L as n,aX as o,aY as d,Q as m,h as u,i as c,aZ as p,R as D,f as h,u as g,v,C as f,B as y,o as b,w as M,F as w,g as S,d as T,M as x}from"./common-DEUjWhYV.js";import{t as O,R as C}from"./tigaHealthPhr__loadShare__react__loadShare__-PlbDaU_c.js";import{C as E,P as I}from"./partial-vitals-card-p6WXWyIj.js";import{c as F,D as H,V as j,d as A,b as N,C as Y,a as L,X as k,u as U,t as R,L as V}from"./animated-CKDtMyWa.js";import"./tigaHealthPhr__mf_v__runtimeInit__mf_v__-DESDpvoH.js";import"./_commonjsHelpers-Dvrxj_Zk.js";import"./preload-helper-Cyd4LpGB.js";const K=e.oneOf(["start","end"]),$=e.oneOfType([K,e.shape({sm:K}),e.shape({md:K}),e.shape({lg:K}),e.shape({xl:K}),e.shape({xxl:K}),e.object]),_={id:e.string,href:e.string,onClick:e.func,title:e.node.isRequired,disabled:e.bool,align:$,menuRole:e.string,renderMenuOnMount:e.bool,rootCloseEvent:e.string,menuVariant:e.oneOf(["dark"]),flip:e.bool,bsPrefix:e.string,variant:e.string,size:e.string},B=O.forwardRef(({title:e,children:i,bsPrefix:r,rootCloseEvent:n,variant:o,size:d,menuRole:m,renderMenuOnMount:u,disabled:c,href:p,id:D,menuVariant:h,flip:g,...v},f)=>t.jsxs(a,{ref:f,...v,children:[t.jsx(l,{id:D,href:p,size:d,variant:o,disabled:c,childBsPrefix:r,children:e}),t.jsx(s,{role:m,renderOnMount:u,rootCloseEvent:n,variant:h,flip:g,children:i})]}));function P(e,t=i,a=r){const l=[];return Object.entries(e).forEach(([e,s])=>{null!=s&&("object"==typeof s?t.forEach(t=>{const i=s[t];if(null!=i){const s=t!==a?`-${t}`:"";l.push(`${e}${s}-${i}`)}}):l.push(`${e}-${s}`))}),l}B.displayName="DropdownButton",B.propTypes=_;const q=O.forwardRef(({as:e="div",bsPrefix:a,className:l,direction:s,gap:i,...r},u)=>{a=n(a,"horizontal"===s?"hstack":"vstack");const c=o(),p=d();return t.jsx(e,{...r,ref:u,className:m(l,a,...P({gap:i,breakpoints:c,minBreakpoint:p}))})});q.displayName="Stack";const z=new class extends u{constructor(){super(`${c.API}/phr`)}saveUserVitals(e,t){super.post("user-vitals",e,t,!0,!0)}getAllUserVitals(e,t){let a=e?.types?`user-vitals/all?${e.types.map(e=>`type=${e}&`).join("")}startDate=${e.startDate}&endDate=${e.endDate}`:`user-vitals/all?startDate=${e.startDate}&endDate=${e.endDate}`;super.get(a,t,!1,!1)}getUserVitalsMinMax(e,t){let a=e?.types?`user-vitals/min-max-by-date-range?${e.types.map(e=>`type=${e}&`).join("")}startDate=${e.startDate}&endDate=${e.endDate}`:`user-vitals/min-max-by-date-range?startDate=${e.startDate}&endDate=${e.endDate}`;a=e.field?a+`&field=${e.field}`:a,super.get(a,t,!1,!1)}};U(R);const W=e=>{const{filter:a,bloodPressureType:l,data:s}=e;return O.useLayoutEffect(()=>{let e=F("bloodPressureChart",k);e.dateFormatter.utc=!1,e.logo.disabled=!0,e.events.on("ready",()=>{e.svgContainer.htmlElement.querySelectorAll('[role="menuitem"], [role="button"], [tabindex]').forEach(e=>{e.removeAttribute("role"),e.removeAttribute("tabindex"),e.removeAttribute("aria-label")})});let t=e.xAxes.push(new H),i=e.yAxes.push(new j);const{startDate:r,endDate:n}=function(e){let t,a,l=new Date;switch(e){case E.WEEK:return a=new Date((new Date).setDate(l.getDate()-6)),t=new Date((new Date).setHours(23,59,59,59)),{startDate:a,endDate:t};case E.MONTH:return a=new Date((new Date).setMonth(l.getMonth()-1)),t=l,{startDate:a,endDate:t};case E.MONTH6:return a=new Date((new Date).setMonth(l.getMonth()-6)),t=l,{startDate:a,endDate:t};case E.MONTH12:return a=new Date((new Date).setMonth(l.getMonth()-11)),t=l,{startDate:a,endDate:t};default:return a=new Date((new Date).setDate(l.getDate()-1)),t=l,{startDate:a,endDate:t}}}(a);return function(e,t,l){switch(e.renderer.grid.template.location=0,e.renderer.labels.template.location=.5,e.dateFormatter.intlLocales="en-GB",e.tooltip.label.fill=N("#FFFFFF"),e.snapTooltip=!1,e.tooltipDateFormat="dd/MMM/yyyy","ar"===p.language&&e.tooltip.label.adapter.add("fill",function(e,t){return t.dom.style.direction="ltr",e}),e.tooltip.label.textAlign="middle",e.tooltip.label.padding(5,10,5,10),a){case E.WEEK:e.dateFormats.setKey("day","EEE"),e.periodChangeDateFormats.setKey("day","EEE"),e.baseInterval={timeUnit:"hour",count:1},e.gridIntervals.setAll([{timeUnit:"day",count:1}]);break;case E.MONTH:e.baseInterval={timeUnit:"day",count:1},e.gridIntervals.setAll([{timeUnit:"week",count:1}]);break;case E.MONTH6:e.dateFormats.setKey("month","MMM"),e.periodChangeDateFormats.setKey("month","MMM"),e.baseInterval={timeUnit:"week",count:1},e.gridIntervals.setAll([{timeUnit:"month",count:1}]);break;case E.MONTH12:e.dateFormats.setKey("month","MMM"),e.periodChangeDateFormats.setKey("month","MMM"),e.gridIntervals.setAll([{timeUnit:"month",count:1}]);break;default:e.dateFormats.setKey("minute","HH:mm"),e.periodChangeDateFormats.setKey("hour","HH:mm"),e.baseInterval={timeUnit:"minute",count:15},e.gridIntervals.setAll([{timeUnit:"minute",count:120}])}if(e.keepSelection=!0,e.groupData=!0,e.min=new Date(t.setHours(0,0,0,0)).getTime(),e.max=l.getTime(),"ar"===p.language&&(e.renderer.tooltip.className="dateAxisClass",e.renderer.labels.template.horizontalCenter="left",a===E.WEEK)){const t={Thu:"خميس",Fri:"جمعة",Sat:"سبت",Sun:"أحد",Mon:"اثنين",Tue:"ثلاثاء",Wed:"أربعاء"};e.renderer.labels.template.adapter.add("textOutput",function(e){return"ar"===p.language&&t[e]||e})}}(t,r,n),((e,t,a)=>{if(t&&t.length>0){let l,s;a===E.DAY?(l=t?.map(e=>e?.values?.DIASTOLIC).filter(e=>void 0!==e),s=t?.map(e=>e?.values?.SYSTOLIC).filter(e=>void 0!==e)):(l=t?.map(e=>e.min).filter(e=>void 0!==e),s=t?.map(e=>e.max).filter(e=>void 0!==e)),e.min=Math.min(...l)-5,e.max=Math.max(...s)+5}else e.min=60,e.max=130;e.renderer.minGridDistance=50,e.tooltip.disabled=!0})(i,s,a),a!==E.MONTH12&&a!==E.MONTH6||t.adapter.add("getTooltipText",function(e,t){const l=t.tooltipDate;let s,i=l;return a===E.MONTH6?s=new Date(i).setDate(i.getDate()+6):(s=new Date(l.getFullYear(),l.getMonth()+1,0),i=new Date(l.getFullYear(),l.getMonth(),1)),((e,t)=>{const a={month:"short"},l=new Intl.DateTimeFormat("en-US",a).format(e),s=new Intl.DateTimeFormat("en-US",a).format(t),i=new Date(e).getDate().toString().padStart(2,"0"),r=new Date(t).getDate().toString().padStart(2,"0"),n=new Date(e).getFullYear();return new Date(t).getMonth()>e.getMonth()?`${l} ${i}-${s} ${r}, ${n}`:`${l} ${i}-${r}, ${n}`})(i,s)}),s?.forEach(t=>{a===E.DAY?(t.openValueY=t?.values?.DIASTOLIC,t.valueY=t?.values?.SYSTOLIC):(t.openValueY=t?.min,t.valueY=t?.max);let s=e.series.push(new A);s.data=[{...t,dateTime:new Date(t?.dateTime)}],s.dataFields.openValueY="openValueY",s.dataFields.valueY="valueY",s.dataFields.dateX="dateTime",s.stroke=N("#4194B3"),s.strokeOpacity=0,s.fillOpacity=0,s.sequencedInterpolation=!0,s.columns.template.width=.01,s.tooltip.pointerOrientation="horizontal",s.tooltip.getFillFromObject=!1,s.tooltip.background.fill=N("#A29475"),s.tooltip.label.fill=N("#fff"),s.snapTooltip=!1,s.tooltipText="ar"===p.language?"{valueY.value} / {openValueY.value} ملم زئبق ":"{valueY.value} / {openValueY.value} [[mm Hg]]","ar"===p.language&&(s.tooltip.pointerOrientation="right",s.tooltip.dx=-10),s.tooltip.label.textAlign="middle",s.tooltip.label.padding(5,10,5,10),a!==E.DAY&&("DIASTOLIC"===l?t.min!==t.max?s.tooltipText="ar"===p.language?"الحد الأدنى لضغط الدم الانبساطي : {openValueY.value} ملم زئبق \n الحد الأعلى لضغط الدم الانبساطي : {valueY.value} ملم زئبق":"Min DBP: {openValueY.value} [[mm Hg]] \n Max DBP: {valueY.value} [[mm Hg]]":s.tooltipText="ar"===p.language?"ملم زئبق {valueY.value}":"{valueY.value} [[mm Hg]]":"SYSTOLIC"===l&&(t.min!==t.max?s.tooltipText="ar"===p.language?"الحد الأدنى لضغط الدم الانقباضي : {openValueY.value} ملم زئبق \n الحد الأعلى لضغط الدم الانقباضي : {valueY.value} ملم زئبق":"Min SBP: {openValueY.value} [[mm Hg]] \n Max SBP: {valueY.value} [[mm Hg]]":s.tooltipText="ar"===p.language?"{valueY.value} ملم زئبق":"{valueY.value} [[mm Hg]]"));let i=s.bullets.create(Y);i.locationY=1,i.circle.fill=a===E.DAY?N("#0D4261"):N("#4194B3"),i.circle.stroke=a===E.DAY?N("#0D4261"):N("#4194B3");let r=s.bullets.create(Y);r.circle.fill=a===E.DAY?N("#4194B3"):N("#0D4261"),r.circle.stroke=a===E.DAY?N("#4194B3"):N("#0D4261"),r.stroke=r.fill}),e.cursor=new L,e.cursor.maxTooltipDistance=-1,e.mouseWheelBehavior="zoomX",()=>{e.dispose()}},[s]),t.jsx("div",{style:{width:"100%",height:"500px"},id:"bloodPressureChart"})};U(R);const G=e=>{const{data:a,type:l,filter:s}=e,i=O.useRef("otherVitalsChart");return O.useLayoutEffect(()=>{let e=F(i.current,k);e.logo.disabled=!0,e.dateFormatter.utc=!1;let t=e.xAxes.push(new H);t.renderer.grid.template.location=0,t.renderer.labels.template.location=.5,t.dateFormatter.intlLocales="en-GB",t.dateFormats.setKey("hour",{hour:"2-digit",minute:"2-digit"}),t.periodChangeDateFormats.setKey("hour",{hour:"2-digit",minute:"2-digit"}),t.dateFormats.setKey("day","dd/MMM/yyyy"),t.periodChangeDateFormats.setKey("day","dd/MMM/yyyy"),t.dateFormats.setKey("week","dd/MMM/yyyy"),t.periodChangeDateFormats.setKey("week","dd/MMM/yyyy"),t.dateFormats.setKey("month","dd/MMM/yyyy"),t.periodChangeDateFormats.setKey("month","dd/MMM/yyyy"),t.tooltip.label.fill=N("#FFFFFF"),t.snapTooltip=!1,t.tooltipDateFormat="dd/MMM/yyyy","ar"===p.language&&t.tooltip.label.adapter.add("fill",function(e,t){return t.dom.style.direction="ltr",e});let r,n,o=new Date;switch(s){case E.DAY:n=new Date(o.getTime()-864e5),r=o,t.dateFormats.setKey("hour","HH:mm"),t.periodChangeDateFormats.setKey("hour","HH:mm"),t.baseInterval={timeUnit:"minute",count:15},t.gridIntervals.setAll([{timeUnit:"minute",count:120}]);break;case E.WEEK:n=new Date((new Date).setDate(o.getDate()-6)),r=new Date((new Date).setHours(23,59,59,59)),t.dateFormats.setKey("day","EEE"),t.periodChangeDateFormats.setKey("day","EEE"),t.baseInterval={timeUnit:"hour",count:1},t.gridIntervals.setAll([{timeUnit:"day",count:1}]);break;case E.MONTH:n=new Date((new Date).setMonth(o.getMonth()-1)),r=new Date,t.baseInterval={timeUnit:"day",count:1},t.gridIntervals.setAll([{timeUnit:"week",count:1}]);break;case E.MONTH6:n=new Date((new Date).setMonth(o.getMonth()-6)),r=o,t.dateFormats.setKey("month","MMM"),t.periodChangeDateFormats.setKey("month","MMM"),t.baseInterval={timeUnit:"week",count:1},t.gridIntervals.setAll([{timeUnit:"month",count:1}]);break;case E.MONTH12:n=new Date((new Date).setMonth(o.getMonth()-11)),r=o,t.dateFormats.setKey("month","MMM"),t.periodChangeDateFormats.setKey("month","MMM"),t.gridIntervals.setAll([{timeUnit:"month",count:1}]);break;default:n=o,r=o}if(t.keepSelection=!0,t.groupData=!0,t.min=new Date(n.setHours(0,0,0,0)).getTime(),t.max=r.getTime(),"ar"===p.language)if(t.renderer.tooltip.className="dateAxisClass",t.renderer.labels.template.horizontalCenter="left",s===E.WEEK){const e={Thu:"خميس",Fri:"جمعة",Sat:"سبت",Sun:"أحد",Mon:"اثنين",Tue:"ثلاثاء",Wed:"أربعاء"};t.renderer.labels.template.adapter.add("textOutput",function(t){return"ar"===p.language&&e[t]||t})}else s===E.MONTH&&t.renderer.labels.template.adapter.add("fill",function(e,t){return t.dom.style.direction="ltr",e});s!==E.MONTH12&&s!==E.MONTH6||t.adapter.add("getTooltipText",function(e,t){const a=t.tooltipDate;let l,i=a;return s===E.MONTH6?l=new Date(i).setDate(i.getDate()+6):(l=new Date(a.getFullYear(),a.getMonth()+1,0),i=new Date(a.getFullYear(),a.getMonth(),1)),((e,t)=>{const a={month:"short"},l=new Intl.DateTimeFormat("en-US",a).format(e),s=new Intl.DateTimeFormat("en-US",a).format(t),i=new Date(e).getDate().toString().padStart(2,"0"),r=new Date(t).getDate().toString().padStart(2,"0"),n=new Date(e).getFullYear();return new Date(t).getMonth()>e.getMonth()?`${l} ${i}-${s} ${r}, ${n}`:`${l} ${i}-${r}, ${n}`})(i,l)});let d=e.yAxes.push(new j);if(a&&a.length>0)if(s!==E.DAY){const e=a.map(e=>e?.min||e?.values?.[l]).filter(e=>void 0!==e),t=a.map(e=>e?.max||e?.values?.[l]).filter(e=>void 0!==e);d.min=Math.min(...e)-5,d.max=Math.max(...t)+5}else{const e=a.map(e=>e?.values?.[l]).filter(e=>void 0!==e);d.min=Math.min(...e)-5,d.max=Math.max(...e)+5}else d.min=60,d.max=110;return d.renderer.minGridDistance=50,d.tooltip.disabled=!0,a?.forEach(t=>{t.value=t?.values?.[l];let a=e.series.push(new V);a.data=[{...t,dateTime:new Date(t?.dateTime)}],a.dataFields.valueY="value",a.dataFields.dateX="dateTime",a.strokeOpacity=0,a.fillOpacity=0,a.tooltip.pointerOrientation="horizontal",a.tooltip.getFillFromObject=!1,a.tooltip.background.fill=N("#A29475"),a.tooltip.label.fill=N("#fff"),a.snapTooltip=!1;const i="BLOOD_GLUCOSE"===l?"mg/dL":"bpm";a.tooltipText=s===E.DAY?"{value} "+i:t?.min&&t?.max?`Min: {min} ${i}\n Max: {max} ${i}`:"{value} "+i,"ar"===p.language&&(a.tooltipText=s===E.DAY?"{value} نبضة في الدقيقة ":t?.min&&t?.max?"الحد الأدنى : {min} نبضة في الدقيقة \n الحد الأعلى : {max} نبضة في الدقيقة ":"{value} نبضة في الدقيقة ",a.tooltip.pointerOrientation="right",a.tooltip.dx=-10),a.tooltip.label.textAlign="middle",a.tooltip.label.padding(5,10,5,10);let r=a.bullets.push(new Y);r.fill=N("#0D4261"),r.circle.fill=N("#0D4261"),r.propertyFields.fill="color",r.strokeOpacity=0,r.strokeWidth=2,r.fillOpacity=1,r.stroke=N("#ffffff"),r.hiddenState.properties.opacity=0}),e.cursor=new L,e.cursor.maxTooltipDistance=-1,e.mouseWheelBehavior="zoomX",()=>{e.dispose()}},[a,s,l]),t.jsx("div",{style:{width:"100%",height:"500px",marginTop:"5px"},id:"otherVitalsChart"})};G.propTypes={data:e.arrayOf(e.shape({id:e.string.isRequired,dateTime:e.string.isRequired,value:e.number.isRequired,type:e.string.isRequired})).isRequired,filter:e.object.isRequired,type:e.string.isRequired};const X=e=>{const{activeCard:a,activeFilter:l,refresh:s,bloodPressureType:i,setBloodPressureType:r,setActiveFilter:n}=e,[o,d]=O.useState("BLOOD_PRESSURE"),[m,u]=O.useState([]),[c,p]=O.useState(null),[g,v]=O.useState(null),[f,y]=O.useState(null);O.useEffect(()=>{d(a.type),n(E.WEEK),r("SYSTOLIC")},[a]),O.useEffect(()=>{c&&f&&T()},[c,f]),O.useEffect(()=>{S()},[o,l,s,i]);const b=(e,t)=>{const a=new Date;return e===E.DAY||e===E.WEEK?a.setDate(a.getDate()-t):a.setMonth(a.getMonth()-t),a.toISOString()},M=()=>{switch(l){case E.DAY:return b(E.DAY,1);case E.WEEK:return b(E.WEEK,6);case E.MONTH:return b(E.MONTH,1);case E.MONTH6:return b(E.MONTH6,6);default:return b(E.MONTH12,12)}},w=(e,t,a=1)=>{if("week"===t){const t=e.getDay(),l=(t<a?7:0)+t-a;e.setDate(e.getDate()-l)}else if("month"===t){const t=e.getDate()-a;e.setDate(e.getDate()-t)}return e.setUTCHours(0,0,0,0),e},S=()=>{const e=(()=>{const e=(new Date).toISOString();return{startDate:M(),endDate:e,types:[o],field:l.unit}})();try{"BLOOD_PRESSURE"===o?l===E.DAY?z.getAllUserVitals(e,e=>{v(e||[])}):z.getUserVitalsMinMax(e,e=>{e="DIASTOLIC"===i?e.filter(e=>"DIASTOLIC"===e.recordType):e.filter(e=>"SYSTOLIC"===e.recordType),v(e||[])}):(z.getAllUserVitals(e,e=>{p(e||[])}),l!==E.DAY&&z.getUserVitalsMinMax(e,e=>{y(e||[])}))}catch(t){}},T=()=>{const e=[],t=c.reduce((e,t)=>{let a=new Date(t.dateTime);return l===E.MONTH6?a=w(a,"week"):l===E.MONTH12&&(a=w(a,"month")),a=a.toLocaleDateString("en").slice(0,10),e[a]||(e[a]=[]),e[a].push(t),e},{}),a=f.reduce((e,t)=>(e[new Date(t.dateTime).toLocaleDateString("en").slice(0,10)]={min:t.min,max:t.max},e),{});Object.keys(t).forEach(l=>{const s=t[l];s.forEach(t=>{s?.length>1&&(t={...t,min:a[l]?.min,max:a[l]?.max}),e.push(t)})}),u(e)};return t.jsx(D,{children:"BLOOD_PRESSURE"===a.type?t.jsx(h,{allowScrollX:!0,style:{minHeight:"510px"},children:t.jsx(W,{data:g,filter:l,bloodPressureType:i})}):t.jsx(h,{allowScrollX:!0,style:{minHeight:"510px"},children:t.jsx(G,{data:m,type:a.type,filter:l})})})},Z=e=>{const{refresh:l,setModal:s,vitalCardsData:i,activeCard:r,setActiveCard:n,updatedVitals:o,setActiveFilter:d,activeFilter:m,childKey:u}=e,[c,p]=O.useState("SYSTOLIC"),{t:h}=g(),b=e=>{p(e)},M=O.useMemo(()=>o?i.map((e,a)=>t.jsx(I,{idx:a+2,item:e,activeClass:r?.type===e?.display?"active":"",activeCard:r,setActiveCard:n,selfAdded:!0,activeFilter:m,setActiveFilter:d},u+a)):C.createElement("div",null),[o,i,m,r]);return t.jsx(v,{cardTitle:h(r.label),cardHeader:null,cardClass:"self-added-vitals-card",cardContent:t.jsxs(D,{className:"self-added-vitals-card-holder",children:[t.jsxs(f,{className:"chartsDiv",lg:9,children:[t.jsxs(q,{className:"dateRow",direction:"horizontal",style:{display:"flex",justifyContent:"space-between"},children:[t.jsxs(q,{direction:"horizontal",gap:2,style:{display:"flex",marginLeft:"2rem",alignContent:"center",alignItems:"center"},children:[t.jsxs(y,{size:"sm",variant:"falcon-default",onClick:()=>s({state:!0,type:r?.type}),children:[t.jsx("i",{className:"ico-plus"}),h("BLOOD_PRESSURE"===r?.type?"self-added-vitals.add-blood-pressure":"BLOOD_GLUCOSE"===r?.type?"self-added-vitals.add-blood-glucose":"self-added-vitals.add-heart-rate")]}),m!==E.DAY&&"BLOOD_PRESSURE"===r?.type&&t.jsxs(B,{className:"bloodPressureDropdown",size:"sm",variant:"falcon-default",id:"dropdown-basic-button",title:"SYSTOLIC"===c?h("self-added-vitals.systolic-bp")+" ("+h("self-added-vitals.sbp")+")":h("self-added-vitals.diastolic-bp")+" ("+h("self-added-vitals.dbp")+")",children:[t.jsx(a.Item,{href:"#",onClick:()=>b("SYSTOLIC"),active:"SYSTOLIC"===c,children:h("self-added-vitals.systolic-bp")+" ("+h("self-added-vitals.sbp")+")"}),t.jsx(a.Item,{href:"#",onClick:()=>b("DIASTOLIC"),active:"DIASTOLIC"===c,children:h("self-added-vitals.diastolic-bp")+" ("+h("self-added-vitals.dbp")+")"})]})]}),t.jsx(q,{direction:"horizontal",style:{display:"flex",alignItems:"center",columnGap:"1.8rem",rowGap:"0.6rem"},className:"dateFilter",children:t.jsxs(q,{direction:"horizontal",style:{display:"flex",alignContent:"center",alignItems:"center",backgroundColor:"#f9fafe",padding:"6px 8px",borderRadius:"5px",marginLeft:"5px",maxHeight:"max-content",flexWrap:"wrap",columnGap:"1.8rem",rowGap:"0.6rem"},children:[t.jsx(f,{className:`cursor ${m===E.DAY&&"vitals-active-filter"}`,onClick:()=>{d(E.DAY)},children:h("self-added-vitals.filter-day")}),t.jsx(f,{className:`cursor ${m===E.WEEK&&"vitals-active-filter"}`,onClick:()=>{d(E.WEEK)},children:h("self-added-vitals.filter-week")}),t.jsx(f,{className:`cursor ${m===E.MONTH&&"vitals-active-filter"}`,onClick:()=>{d(E.MONTH)},children:h("self-added-vitals.filter-month")}),t.jsx(f,{className:`cursor ${m===E.MONTH6&&"vitals-active-filter"}`,style:{whiteSpace:"nowrap"},onClick:()=>{d(E.MONTH6)},children:h("self-added-vitals.filter-half-year")}),t.jsx(f,{className:`cursor ${m===E.MONTH12&&"vitals-active-filter"}`,onClick:()=>{d(E.MONTH12)},children:h("self-added-vitals.filter-year")})]})})]}),t.jsx(f,{children:t.jsx(X,{refresh:l,activeCard:r,activeFilter:m,setActiveFilter:d,bloodPressureType:c,setBloodPressureType:p})})]}),t.jsx(f,{className:"partial-cards",lg:3,children:M})]})})},Q=e=>{const{t:a}=g(),{getValues:l,register:s,handleSubmit:i,setValue:r,control:n,formState:{errors:o}}=b(),{setModal:d,refresh:m,setRefresh:u}=e,[c,p]=O.useState(new Date),D=[{visibilityState:!0,ColLg:"12",item:"DATEPICKER",itemType:"datepicker",label:a("smart-assistant.daily-activity-date"),labelStatus:!0,name:"Date",id:"date",className:null,clearItem:!1,rowFixed:!1,maxDate:new Date,endDate:null,startDate:null,minDate:new Date((new Date).setMonth((new Date).getMonth()-1)),defaultValue:c,dateFormat:"dd/MM/yyyy",showMonth:!0,showYear:!0,onChange:e=>p(e),placeholder:!1,required:!0,requiredMessage:a("validation-error-mesaj"),readOnly:!1,disabled:!1},{visibilityState:!0,ColLg:"12",item:"DATEPICKER",itemType:"datepicker",label:a("smart-assistant.hour"),labelStatus:!0,name:"Time",id:"time",showTimeSelectOnly:!0,showTimeSelect:!0,timeIntervals:15,className:null,clearItem:!1,rowFixed:!1,minTime:new Date((new Date).setHours(0,0,0,0)),maxTime:new Date(c).getDate()===(new Date).getDate()?new Date:new Date((new Date).setHours(23,59,59,999)),defaultValue:new Date,dateFormat:"HH:mm",timeFormat:"HH:mm",onChange:void 0,placeholder:null,required:!0,requiredMessage:a("validation-error-mesaj"),readOnly:!1,disabled:!1},{visibilityState:!0,ColLg:"12",item:"INPUT",itemType:"mask",mask:"999",label:a("self-added-vitals.add-hr-label"),labelStatus:!0,name:"heartRate",id:"heartRate",placeholder:a("self-added-vitals.add-hr-label"),defaultValue:"",onChange:void 0,disabled:!1,autoComplete:"off",required:!0,requiredType:{required:a("validation-error-mesaj"),min:{value:30,message:a("self-added-vitals.hr-validation")}},requiredMessage:a("validation-error-mesaj")}];return t.jsxs(M,{onSubmit:i(()=>{let e={dateTime:new Date(S(l("Date"),"YYYY-MM-DD")+" "+S(l("Time"),"HH:mm")).toISOString(),type:"HEART_RATE",values:{HEART_RATE:Number(l("heartRate"))}};z.saveUserVitals(e,e=>{e&&(d(!1),u(!m))})}),style:{width:"100%",position:"relative",overflow:"visible"},children:[t.jsx(w,{CreateFormItems:D,register:s,setValue:r,errors:o,control:n}),t.jsxs(f,{xs:12,justify:"end",className:"mt-3",children:[t.jsx(y,{id:"CancelBtn",variant:"danger",className:"mr-2",size:"sm",type:"button",onClick:()=>d(!1),children:a("button.cancel")}),t.jsx(y,{id:"organBtn",className:"mr-2",variant:"success",size:"sm",type:"submit",children:a("button.save")})]})]})},J=e=>{const{t:a}=g(),{getValues:l,register:s,handleSubmit:i,setValue:r,control:n,formState:{errors:o}}=b(),{setModal:d,refresh:m,setRefresh:u}=e,[c,p]=O.useState(new Date),D=[{visibilityState:!0,ColLg:"12",item:"DATEPICKER",itemType:"datepicker",label:a("smart-assistant.daily-activity-date"),labelStatus:!0,name:"Date",id:"date",className:null,clearItem:!1,rowFixed:!1,maxDate:new Date,endDate:null,startDate:null,minDate:new Date((new Date).setMonth((new Date).getMonth()-1)),defaultValue:c,dateFormat:"dd/MM/yyyy",showMonth:!0,showYear:!0,onChange:e=>p(e),placeholder:!1,required:!0,requiredMessage:a("validation-error-mesaj"),readOnly:!1,disabled:!1},{visibilityState:!0,ColLg:"12",item:"DATEPICKER",itemType:"datepicker",label:a("smart-assistant.hour"),labelStatus:!0,name:"Time",id:"time",showTimeSelectOnly:!0,showTimeSelect:!0,timeIntervals:15,className:null,clearItem:!1,rowFixed:!1,minTime:new Date((new Date).setHours(0,0,0,0)),maxTime:new Date(c).getDate()===(new Date).getDate()?new Date:new Date((new Date).setHours(23,59,59,999)),defaultValue:new Date,dateFormat:"HH:mm",timeFormat:"HH:mm",onChange:void 0,placeholder:null,required:!0,requiredMessage:a("validation-error-mesaj"),readOnly:!1,disabled:!1},{visibilityState:!0,ColLg:"12",item:"INPUT",itemType:"mask",mask:"999",label:a("self-added-vitals.add-bg-label"),labelStatus:!0,name:"glucose",id:"glucose",placeholder:a("self-added-vitals.add-bg-label"),defaultValue:"",onChange:void 0,disabled:!1,autoComplete:"off",required:!0,requiredType:{required:a("validation-error-mesaj")},requiredMessage:a("validation-error-mesaj")}];return t.jsxs(M,{onSubmit:i(()=>{let e={dateTime:new Date(S(l("Date"),"YYYY-MM-DD")+" "+S(l("Time"),"HH:mm")).toISOString(),type:"BLOOD_GLUCOSE",values:{BLOOD_GLUCOSE:Number(l("glucose"))}};z.saveUserVitals(e,e=>{e&&(d(!1),u(!m))})}),style:{width:"100%",position:"relative",overflow:"visible"},children:[t.jsx(w,{CreateFormItems:D,register:s,setValue:r,errors:o,control:n}),t.jsxs(f,{xs:12,justify:"end",className:"mt-3",children:[t.jsx(y,{id:"CancelBtn",variant:"danger",className:"mr-2",size:"sm",type:"button",onClick:()=>d(!1),children:a("button.cancel")}),t.jsx(y,{id:"organBtn",className:"mr-2",variant:"success",size:"sm",type:"submit",children:a("button.save")})]})]})},ee=e=>{const{t:a}=g(),{getValues:l,register:s,handleSubmit:i,setValue:r,control:n,formState:{errors:o},setError:d}=b(),{setModal:m,refresh:u,setRefresh:c}=e,[p,D]=O.useState(new Date);s("systolic",{validate:{notEmpty:e=>""!==e.trim()||a("validation-error-mesaj"),minValue:e=>Number(e)>=40||a("self-added-vitals.systolic-validation"),greaterThanDiastolic:e=>Number(e)>Number(l("diastolic"))||a("self-added-vitals.greater-than-diastolic")}}),s("diastolic",{validate:{notEmpty:e=>""!==e.trim()||a("validation-error-mesaj"),minValue:e=>Number(e)>=30||a("self-added-vitals.diastolic-validation"),lessThanSystolic:e=>Number(e)<Number(l("systolic"))||a("self-added-vitals.less-than-systolic")}});const h=[{visibilityState:!0,ColLg:"12",item:"DATEPICKER",itemType:"datepicker",label:a("smart-assistant.daily-activity-date"),labelStatus:!0,name:"Date",id:"date",className:null,clearItem:!1,rowFixed:!1,maxDate:new Date,endDate:null,startDate:null,minDate:new Date((new Date).setMonth((new Date).getMonth()-1)),defaultValue:p,dateFormat:"dd/MM/yyyy",showMonth:!0,showYear:!0,onChange:e=>D(e),placeholder:!1,required:!0,requiredMessage:a("validation-error-mesaj"),readOnly:!1,disabled:!1},{visibilityState:!0,ColLg:"12",item:"DATEPICKER",itemType:"datepicker",label:a("smart-assistant.hour"),labelStatus:!0,name:"Time",id:"time",showTimeSelectOnly:!0,showTimeSelect:!0,timeIntervals:15,className:null,clearItem:!1,rowFixed:!1,minTime:new Date((new Date).setHours(0,0,0,0)),maxTime:new Date(p).getDate()===(new Date).getDate()?new Date:new Date((new Date).setHours(23,59,59,999)),defaultValue:new Date,dateFormat:"HH:mm",timeFormat:"HH:mm",onChange:void 0,placeholder:null,required:!0,requiredMessage:a("validation-error-mesaj"),readOnly:!1,disabled:!1},{visibilityState:!0,ColLg:"6",item:"INPUT",itemType:"mask",mask:"999",label:a("self-added-vitals.systolic-pressure"),labelStatus:!0,name:"systolic",id:"systolic",placeholder:a("self-added-vitals.systolic"),defaultValue:"",onChange:void 0,disabled:!1,autoComplete:"off",required:!0},{visibilityState:!0,ColLg:"6",item:"INPUT",itemType:"mask",mask:"999",label:a("self-added-vitals.diastolic-pressure"),labelStatus:!0,name:"diastolic",id:"diastolic",placeholder:a("self-added-vitals.diastolic"),defaultValue:"",onChange:void 0,disabled:!1,autoComplete:"off",required:!0}];return t.jsxs(M,{onSubmit:i(()=>{let e={dateTime:new Date(S(l("Date"),"YYYY-MM-DD")+" "+S(l("Time"),"HH:mm")).toISOString(),type:"BLOOD_PRESSURE",values:{DIASTOLIC:l("diastolic"),SYSTOLIC:l("systolic")}};z.saveUserVitals(e,e=>{e&&(m(!1),c(!u))})}),style:{width:"100%",position:"relative",overflow:"visible"},children:[t.jsx(w,{CreateFormItems:h,register:s,setValue:r,errors:o,control:n,setError:d}),t.jsx("h1",{style:{position:"absolute",bottom:"21%",left:"49%"},className:"responsive-hidden",ref:e=>{e&&e.style.setProperty("font-size","2rem","important")},children:"/"}),t.jsxs(f,{xs:12,justify:"end",className:"mt-3",children:[t.jsx(y,{id:"CancelBtn",variant:"danger",className:"mr-2",size:"sm",type:"button",onClick:()=>m(!1),children:a("button.cancel")}),t.jsx(y,{id:"organBtn",className:"mr-2",variant:"success",size:"sm",type:"submit",children:a("button.save")})]})]})},te=()=>{const{t:e}=g(),[a,l]=O.useState({state:!1,type:null}),[s,i]=O.useState(E.WEEK),[r,n]=O.useState({type:"BLOOD_PRESSURE",label:e("vital-sign.label-blood-pressure")}),[o,d]=O.useState(0),[m,u]=O.useState(self.crypto.randomUUID()),c=[{code:"85354-9",display:"BLOOD_PRESSURE",valueList:[{label:"DIASTOLIC_MAX",value:null,unit:"[mm Hg]"},{label:"DIASTOLIC_MIN",value:null,unit:"[mm Hg]"},{label:"SYSTOLIC_MAX",value:null,unit:"[mm Hg]"},{label:"SYSTOLIC_MIN",value:null,unit:"[mm Hg]"}]},{code:"8867-4",display:"HEART_RATE",valueList:[{label:"MAX",value:null,unit:"bpm"},{label:"MIN",value:null,unit:"bpm"}]},{code:"2339-0",display:"BLOOD_GLUCOSE",valueList:[{label:"MAX",value:null,unit:"mg/dL"},{label:"MIN",value:null,unit:"mg/dL"}]}],[p,D]=O.useState(c),[h,f]=O.useState(!1);return O.useEffect(()=>{const e=(new Date).toISOString(),t=s===E.DAY?new Date((new Date).setDate((new Date).getDate()-1)).toISOString():s===E.WEEK?new Date((new Date).setDate((new Date).getDate()-6)).toISOString():s===E.MONTH?new Date((new Date).setMonth((new Date).getMonth()-1)).toISOString():s===E.MONTH6?new Date((new Date).setMonth((new Date).getMonth()-6)).toISOString():new Date((new Date).setFullYear((new Date).getFullYear()-1)).toISOString();var a;a={startDate:t,endDate:e},z.getUserVitalsMinMax(a,e=>e?(e=>{const t=c.map(t=>{const a=e.filter(e=>e.vitalSignsType===t.display),l=t.valueList.map(e=>{const l=a.find(a=>"BLOOD_PRESSURE"===t.display?e.label.includes(a.recordType.toUpperCase()):"MAX"===e.label||"MIN"===e.label);if(l){if(e.label.includes("MAX"))return{...e,value:l.max};if(e.label.includes("MIN"))return{...e,value:l.min}}return e});return{...t,valueList:l}});D(t),d(e=>e+1),u(self.crypto.randomUUID())})(e):D(c))},[s,h]),t.jsxs(T,{resourceName:"menu.self-added-vitals",permission:"read",type:"page",children:[t.jsx(x,{modal:a?.type,modaltitleText:e("BLOOD_PRESSURE"===r?.type?"self-added-vitals.add-blood-pressure":"BLOOD_GLUCOSE"===r?.type?"self-added-vitals.add-blood-glucose":"self-added-vitals.add-heart-rate"),modalWidth:"30%",alignment:"top",toggle:()=>l({state:!1}),component:"BLOOD_PRESSURE"===a?.type?t.jsx(ee,{setModal:l,refresh:h,setRefresh:f}):"BLOOD_GLUCOSE"===r?.type?t.jsx(J,{setModal:l,refresh:h,setRefresh:f}):t.jsx(Q,{setModal:l,refresh:h,setRefresh:f})}),t.jsx(v,{cardTitle:e("menu.self-added-vitals"),cardLight:!1,cardHeader:null,cardClass:"self-added-vitals-card",cardContent:t.jsx(Z,{refresh:h,vitalCardsData:p,setModal:l,activeCard:r,setActiveCard:n,updatedVitals:o,activeFilter:s,setActiveFilter:i,childKey:m})})]})};export{te as default};
