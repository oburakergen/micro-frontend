import{u as e,o as a,j as s,M as i,w as t,l,F as r,C as n,B as o,T as d}from"./common-DEUjWhYV.js";import{t as m}from"./tigaHealthPhr__loadShare__react__loadShare__-PlbDaU_c.js";import{s as c}from"./procedure-card-CLlm88W2.js";import{D as h}from"./dashboard-api-CaDzrB6T.js";const u=u=>{const{PatientInfo:b,SaveStatus:x}=u,[g,p]=m.useState(!1),[j,f]=m.useState(null),[v,N]=m.useState(null),[C,y]=m.useState(null),[L,w]=m.useState(!1),{t:S,i18n:I}=e(),{clearErrors:k,register:F,handleSubmit:T,formState:{errors:B},control:D,setValue:_}=a();m.useEffect(()=>{!g&&w(!1),k()},[g]),m.useEffect(()=>{const e=j?.bmi?S(j?.bmi>18.5&&j?.bmi<25?"dashboard.normal-limit":"dashboard.outside-limit"):"";N(e)},[I.language]),m.useEffect(()=>{b&&!x?q(b?.height,b?.weight,f):b&&x&&z(b?.phrId)},[b]);const z=e=>{h.getBmi(e,e=>{f({bmi:e?parseInt(e):"-",lowerLimit:0,upperLimit:0,isLimit:e>18.5&&e<25});const a=e?S(e>18.5&&e<25?"dashboard.normal-limit":"dashboard.outside-limit"):"";N(a)})},q=(e,a,s)=>{if("-"!=e&&"-"!=a&&null!=e&&null!=a){let i=parseInt(e),t=parseInt(a)/(i/100*i/100);s({bmi:t.toFixed(2),lowerLimit:(i/100*i/100*18.5).toFixed(1),upperLimit:(i/100*i/100*24.9).toFixed(1),isLimit:t>18.5&&t<25,message:S(t>18.5&&t<25?"dashboard.normal-limit":"dashboard.outside-limit")})}else s({bmi:"-",lowerLimit:0,upperLimit:0,isLimit:!1,message:"-"})},E=[{visibilityState:!0,ColLg:"12",item:"INPUT",itemType:"mask",label:S("patient-profile-card.height-unit"),labelStatus:!0,name:"height",id:"height",className:null,readOnly:null,rowFixed:!1,clearItem:null,defaultValue:"",placeholder:S("patient-profile-card.height-unit"),onChange:void 0,mask:"999",required:!0,requiredType:{maxLength:{value:3,message:S("value-validation-message")},required:S("validation-error-mesaj")},disabled:!1,autoComplete:"off"},{visibilityState:!0,ColLg:"12",item:"INPUT",itemType:"mask",label:S("patient-profile-card.weight-unit"),labelStatus:!0,name:"weight",id:"weight",className:null,readOnly:null,rowFixed:!1,clearItem:null,defaultValue:"",mask:"999",placeholder:S("patient-profile-card.weight-unit"),onChange:void 0,required:!0,requiredType:{maxLength:{value:3,message:S("value-validation-message")},required:S("validation-error-mesaj")},disabled:!1,autoComplete:"off"}];return s.jsxs(m.Fragment,{children:[g&&s.jsx(i,{modal:g,modaltitleText:S("dashboard.calculate-body-mass-index"),modalWidth:"30%",alignment:"top",toggle:()=>p(!1),modalFooter:L&&s.jsxs(m.Fragment,{children:[s.jsx(o,{id:"CancelBtn",variant:"danger",className:"mr-2",size:"sm",type:"button",onClick:()=>p(!1),children:S("button.cancel")}),s.jsx(o,{id:"reCalculateBtn",variant:"info",className:"mr-2",size:"sm",type:"button",onClick:()=>w(!1),children:S("button.recalculate")}),s.jsx(o,{id:"SaveBtn",variant:"success",className:"mr-2",size:"sm",type:"button",onClick:()=>{return e=b?.phrId,a=C?.bmi,void h.saveBmi(e,a,a=>{z(e),w(!1),p(!1)});var e,a},children:S("button.save")})]}),component:L?s.jsx("div",{className:"min-height-195",children:s.jsxs("div",{className:C?.isLimit?"DashboardCard small bg6 box-shadow-none":"DashboardCard small bg5 box-shadow-none",children:[s.jsx("i",{className:"ico-weight-scale-1 CardIcon"}),s.jsx("div",{className:"header",children:s.jsx("h3",{children:S("dashboard.body-mass-index")})}),s.jsxs("div",{className:"DashboardContent bmi-card",children:[s.jsxs("h3",{children:[C?.bmi,s.jsx("span",{className:"font-size-20",children:" kg/m2"}),s.jsx(d,{label:C?.message,children:s.jsx("i",{className:"ico-info cursor"})})]}),s.jsxs("p",{className:"bmi-text",children:[S("dashboard.text-lower-limit"),s.jsxs("b",{children:[" ",C?.lowerLimit]})," kg ",s.jsx("br",{}),S("dashboard.text-upper-limit"),s.jsxs("b",{children:[" ",C?.upperLimit]})," kg"]})]})]})}):s.jsxs(t,{onSubmit:T(e=>{q(e.height,e.weight,y),w(!0)}),children:[s.jsx(l,{alertType:"info",alertText:s.jsxs("p",{className:"mb-0 marginRight20 bmiInfoMessage",children:[s.jsx("i",{className:"ico-info"})," "," "+S("smart-assistant.bmi-alert-info")]})}),s.jsx(r,{CreateFormItems:E,register:F,setValue:_,errors:B,control:D}),s.jsxs(n,{xs:12,justify:"end",className:"mt-3",children:[s.jsx(o,{id:"CancelBtn",variant:"danger",className:"mr-2",size:"sm",type:"button",onClick:()=>p(!1),children:S("button.cancel")}),s.jsx(o,{id:"calculateBtn",variant:"success",size:"sm",type:"submit",children:S("button.calculate")})]})]})}),s.jsxs("div",{className:j?.isLimit?"DashboardCard small bg6 bmi-inside-of-range":"DashboardCard small bg5 bmi-out-of-range",children:[s.jsx("div",{className:"DashboardBorder"}),s.jsx("i",{className:"ico-size-scale CardIcon"}),s.jsx("div",{className:"header",children:s.jsx("h3",{children:S("dashboard.body-mass-index")})}),s.jsxs("div",{className:"DashboardContent bmi-card",children:[c(j?.bmi,!0),s.jsxs("h3",{children:[j?.bmi,x&&s.jsx(d,{label:v||"-",children:s.jsx("i",{className:"ico-info cursor"})})]}),x?s.jsx("span",{className:"cursor hoverLink calculate-btn",onClick:()=>p(!0),children:s.jsx("b",{children:S("button.calculate")})}):s.jsx("span",{children:s.jsx("b",{children:v})})]})]})]})};export{u as P};
